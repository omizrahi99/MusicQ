{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/gautam/Desktop/cs/48/project-s1-t1-music-queue/pages/App.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport Router from \"next/router\";\nimport Link from \"next/link\";\nimport Layout from \"../components/Layout\";\nimport Results from \"../components/Results\";\nimport Input from \"../components/Input\";\nvar spotifySearchURL = \"https://api.spotify.com/v1/search?q=\";\nvar spotifyProfileURL = \"https://api.spotify.com/v1/me?access_token=\";\n\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n\n  var _super = _createSuper(App);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      if (window.location.href.indexOf(\"_token\") == -1) {\n        Router.push(\"/Login\");\n      }\n\n      console.log(\"cdm ran\");\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"submitTrackForm\", function (event) {\n      event.preventDefault();\n      var search_term = _this.state.search_term;\n      var access_token = _this.props.url.query.access_token;\n\n      if (search_term != \"\") {\n        fetch(\"\".concat(spotifySearchURL).concat(search_term, \"&type=track&access_token=\").concat(access_token)).then(function (response) {\n          return response.json();\n        }).then(function (json) {\n          _this.setState({\n            tracks: json.tracks.items\n          });\n\n          return json.tracks;\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderSearchResults\", function () {\n      if (_this.state.tracks.length > 1) {\n        var tracks = _this.state.tracks;\n        var access_token = _this.props.url.query.access_token;\n        var allResults = [];\n        tracks.forEach(function (track, index) {\n          if (track.album != undefined && track.album.images[0] != undefined) {\n            var hasImage = track.album.images[0];\n            allResults.push(__jsx(Results, {\n              key: track.id,\n              imageURL: hasImage.url,\n              name: track.name,\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 56,\n                columnNumber: 13\n              }\n            }, __jsx(Link, {\n              href: \"/track-albums?id=\".concat(track.id, \"&access_token=\").concat(access_token),\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 57,\n                columnNumber: 15\n              }\n            }, __jsx(\"a\", {\n              className: \"text-muted\",\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 60,\n                columnNumber: 17\n              }\n            }, \"View \", track.name, \" albums\"))));\n          }\n        });\n        return allResults;\n      } else {\n        return \"\";\n      }\n    });\n\n    _this.state = {\n      search_term: \"\",\n      tracks: []\n    };\n    _this.submitTrackForm = _this.submitTrackForm.bind(_assertThisInitialized(_this));\n    _this.renderSearchResults = _this.renderSearchResults.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      console.log(\"this.state\", this.state);\n      var user = this.props.user;\n      return __jsx(Layout, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 7\n        }\n      }, __jsx(Input, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 77,\n          columnNumber: 9\n        }\n      }), __jsx(\"div\", {\n        className: \"row mt-5 justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 9\n        }\n      }, __jsx(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 11\n        }\n      }, \"Welcome \", user.display_name.split(\" \")[0], \"!\")), __jsx(\"div\", {\n        className: \"row mt-5 justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 81,\n          columnNumber: 9\n        }\n      }, __jsx(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 82,\n          columnNumber: 11\n        }\n      }, this.state.tracks.length > 1 ? \"Search results for \\\"\".concat(this.state.search_term, \"\\\"\") : \"Search the Spotify API for your favorite track\")), __jsx(\"div\", {\n        className: \"row mt-5 justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 88,\n          columnNumber: 9\n        }\n      }, __jsx(\"form\", {\n        onSubmit: function onSubmit(event) {\n          return _this2.submitTrackForm(event);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 11\n        }\n      }, __jsx(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 13\n        }\n      }, __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control text-center\",\n        placeholder: \"enter track name\",\n        onChange: function onChange(event) {\n          return _this2.setState({\n            search_term: event.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 15\n        }\n      })), __jsx(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }\n      }, __jsx(\"button\", {\n        type: \"submit\",\n        className: \"form-control btn btn-outline-success\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 15\n        }\n      }, \"Search\")))), __jsx(\"div\", {\n        className: \"row mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 9\n        }\n      }, this.renderSearchResults()));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nApp.getInitialProps = function _callee(context) {\n  var access_token, res, user;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          access_token = context.query.access_token;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(fetch(spotifyProfileURL + access_token));\n\n        case 3:\n          res = _context.sent;\n          _context.next = 6;\n          return _regeneratorRuntime.awrap(res.json());\n\n        case 6:\n          user = _context.sent;\n          return _context.abrupt(\"return\", {\n            user: user\n          });\n\n        case 8:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/gautam/Desktop/cs/48/project-s1-t1-music-queue/pages/App.js"],"names":["React","Component","fetch","Router","Link","Layout","Results","Input","spotifySearchURL","spotifyProfileURL","App","props","window","location","href","indexOf","push","console","log","event","preventDefault","search_term","state","access_token","url","query","then","response","json","setState","tracks","items","length","allResults","forEach","track","index","album","undefined","images","hasImage","id","name","submitTrackForm","bind","renderSearchResults","user","display_name","split","target","value","getInitialProps","context","res"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport fetch from \"isomorphic-unfetch\";\nimport Router from \"next/router\";\nimport Link from \"next/link\";\nimport Layout from \"../components/Layout\";\nimport Results from \"../components/Results\";\nimport Input from \"../components/Input\";\n\nconst spotifySearchURL = \"https://api.spotify.com/v1/search?q=\";\nconst spotifyProfileURL = \"https://api.spotify.com/v1/me?access_token=\";\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      search_term: \"\",\n      tracks: []\n    };\n    this.submitTrackForm = this.submitTrackForm.bind(this);\n    this.renderSearchResults = this.renderSearchResults.bind(this);\n  }\n\n  componentDidMount = () => {\n    if (window.location.href.indexOf(\"_token\") == -1) {\n      Router.push(\"/Login\");\n    }\n    console.log(\"cdm ran\");\n  };\n\n  submitTrackForm = event => {\n    event.preventDefault();\n    const { search_term } = this.state;\n    const { access_token } = this.props.url.query;\n\n    if (search_term != \"\") {\n      fetch(\n        `${spotifySearchURL}${search_term}&type=track&access_token=${access_token}`\n      )\n        .then(response => response.json())\n        .then(json => {\n          this.setState({ tracks: json.tracks.items });\n          return json.tracks;\n        });\n    }\n  };\n\n  renderSearchResults = () => {\n    if (this.state.tracks.length > 1) {\n      const { tracks } = this.state;\n      const { access_token } = this.props.url.query;\n      let allResults = [];\n      tracks.forEach((track, index) => {\n        if (track.album != undefined && track.album.images[0] != undefined) {\n          let hasImage = track.album.images[0];\n          allResults.push(\n            <Results key={track.id} imageURL={hasImage.url} name={track.name}>\n              <Link\n                href={`/track-albums?id=${track.id}&access_token=${access_token}`}\n              >\n                <a className=\"text-muted\">View {track.name} albums</a>\n              </Link>\n            </Results>\n          );\n        }\n      });\n      return allResults;\n    } else {\n      return \"\";\n    }\n  };\n\n  render() {\n    console.log(\"this.state\", this.state);\n    const { user } = this.props;\n    return (\n      <Layout>\n        <Input />\n        <div className=\"row mt-5 justify-content-center\">\n          <h3>Welcome {user.display_name.split(\" \")[0]}!</h3>\n        </div>\n        <div className=\"row mt-5 justify-content-center\">\n          <h3>\n            {this.state.tracks.length > 1\n              ? `Search results for \"${this.state.search_term}\"`\n              : \"Search the Spotify API for your favorite track\"}\n          </h3>\n        </div>\n        <div className=\"row mt-5 justify-content-center\">\n          <form onSubmit={event => this.submitTrackForm(event)}>\n            <div className=\"form-group\">\n              <input\n                type=\"text\"\n                className=\"form-control text-center\"\n                placeholder=\"enter track name\"\n                onChange={event =>\n                  this.setState({ search_term: event.target.value })\n                }\n              />\n            </div>\n            <div className=\"form-group\">\n              <button\n                type=\"submit\"\n                className=\"form-control btn btn-outline-success\"\n              >\n                Search\n              </button>\n            </div>\n          </form>\n        </div>\n        <div className=\"row mt-5\">{this.renderSearchResults()}</div>\n      </Layout>\n    );\n  }\n}\n\nApp.getInitialProps = async function(context) {\n  const { access_token } = context.query;\n  const res = await fetch(spotifyProfileURL + access_token);\n  const user = await res.json();\n  return {\n    user\n  };\n};\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}