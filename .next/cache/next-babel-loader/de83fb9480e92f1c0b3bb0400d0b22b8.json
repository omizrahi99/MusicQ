{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/shonnavalli/cs48/project-s1-t1-music-queue/pages/App.js\";\nvar __jsx = React.createElement;\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from 'react';\nimport fetch from 'isomorphic-unfetch';\nimport Router from 'next/router';\nimport Link from 'next/link';\nimport Layout from '../components/Layout';\nimport Results from '../components/Results';\nvar spotifySearchURL = \"https://api.spotify.com/v1/search?q=\";\nvar spotifyProfileURL = \"https://api.spotify.com/v1/me?access_token=\";\n\nvar App = /*#__PURE__*/function (_Component) {\n  _inherits(App, _Component);\n\n  var _super = _createSuper(App);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"componentDidMount\", function () {\n      if (window.location.href.indexOf('_token') == -1) {\n        Router.push('/Login');\n      }\n\n      console.log('cdm ran');\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"submitArtistForm\", function (event) {\n      event.preventDefault();\n      var search_term = _this.state.search_term;\n      var access_token = _this.props.url.query.access_token;\n\n      if (search_term != '') {\n        fetch(\"\".concat(spotifySearchURL).concat(search_term, \"&type=track&access_token=\").concat(access_token)).then(function (response) {\n          return response.json();\n        }).then(function (json) {\n          _this.setState({\n            tracks: json.tracks.items\n          });\n\n          return json.tracks;\n        });\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"renderSearchResults\", function () {\n      if (_this.state.tracks.length > 1) {\n        var tracks = _this.state.tracks;\n        var access_token = _this.props.url.query.access_token;\n        var allResults = [];\n        tracks.forEach(function (track, index) {\n          if (track.images[0] != undefined) {\n            var hasImage = track.images[0];\n            allResults.push(__jsx(Results, {\n              key: track.id,\n              imageURL: hasImage.url,\n              name: track.name,\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 52,\n                columnNumber: 23\n              }\n            }, __jsx(Link, {\n              href: \"/artist-albums?id=\".concat(track.id, \"&access_token=\").concat(access_token),\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 57,\n                columnNumber: 24\n              }\n            }, __jsx(\"a\", {\n              className: \"text-muted\",\n              __self: _assertThisInitialized(_this),\n              __source: {\n                fileName: _jsxFileName,\n                lineNumber: 58,\n                columnNumber: 27\n              }\n            }, \"View \", track.name, \" albums\"))));\n          }\n        });\n        return allResults;\n      } else {\n        return '';\n      }\n    });\n\n    _this.state = {\n      search_term: '',\n      tracks: []\n    };\n    _this.submitArtistForm = _this.submitArtistForm.bind(_assertThisInitialized(_this));\n    _this.renderSearchResults = _this.renderSearchResults.bind(_assertThisInitialized(_this));\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      console.log('this.state', this.state);\n      var user = this.props.user;\n      return __jsx(Layout, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 74,\n          columnNumber: 11\n        }\n      }, __jsx(\"div\", {\n        className: \"row mt-5 justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 75,\n          columnNumber: 17\n        }\n      }, __jsx(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 76,\n          columnNumber: 21\n        }\n      }, \"Welcome \", user.display_name.split(\" \")[0], \"!\")), __jsx(\"div\", {\n        className: \"row mt-5 justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 78,\n          columnNumber: 15\n        }\n      }, __jsx(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 79,\n          columnNumber: 19\n        }\n      }, this.state.tracks.length > 1 ? \"Search results for \\\"\".concat(this.state.search_term, \"\\\"\") : 'Search the Spotify API for your favorite artist')), __jsx(\"div\", {\n        className: \"row mt-5 justify-content-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 15\n        }\n      }, __jsx(\"form\", {\n        onSubmit: function onSubmit(event) {\n          return _this2.submitArtistForm(event);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 19\n        }\n      }, __jsx(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 23\n        }\n      }, __jsx(\"input\", {\n        type: \"text\",\n        className: \"form-control text-center\",\n        placeholder: \"enter artist name\",\n        onChange: function onChange(event) {\n          return _this2.setState({\n            search_term: event.target.value\n          });\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 27\n        }\n      })), __jsx(\"div\", {\n        className: \"form-group\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 23\n        }\n      }, __jsx(\"button\", {\n        type: \"submit\",\n        className: \"form-control btn btn-outline-success\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 27\n        }\n      }, \"Search\")))), __jsx(\"div\", {\n        className: \"row mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 104,\n          columnNumber: 15\n        }\n      }, this.renderSearchResults()));\n    }\n  }]);\n\n  return App;\n}(Component);\n\nApp.getInitialProps = function _callee(context) {\n  var access_token, res, user;\n  return _regeneratorRuntime.async(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          access_token = context.query.access_token;\n          _context.next = 3;\n          return _regeneratorRuntime.awrap(fetch(spotifyProfileURL + access_token));\n\n        case 3:\n          res = _context.sent;\n          _context.next = 6;\n          return _regeneratorRuntime.awrap(res.json());\n\n        case 6:\n          user = _context.sent;\n          return _context.abrupt(\"return\", {\n            user: user\n          });\n\n        case 8:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nexport default App;","map":{"version":3,"sources":["/Users/shonnavalli/cs48/project-s1-t1-music-queue/pages/App.js"],"names":["React","Component","fetch","Router","Link","Layout","Results","spotifySearchURL","spotifyProfileURL","App","props","window","location","href","indexOf","push","console","log","event","preventDefault","search_term","state","access_token","url","query","then","response","json","setState","tracks","items","length","allResults","forEach","track","index","images","undefined","hasImage","id","name","submitArtistForm","bind","renderSearchResults","user","display_name","split","target","value","getInitialProps","context","res"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport fetch from 'isomorphic-unfetch'\nimport Router from 'next/router'\nimport Link from 'next/link'\nimport Layout from '../components/Layout'\nimport Results from '../components/Results'\nconst spotifySearchURL = \"https://api.spotify.com/v1/search?q=\";\nconst spotifyProfileURL = \"https://api.spotify.com/v1/me?access_token=\";\n\nclass App extends Component {\n  constructor(props) {\n      super(props);\n      this.state = {\n          search_term: '',\n          tracks: []\n      }\n      this.submitArtistForm = this.submitArtistForm.bind(this);\n      this.renderSearchResults = this.renderSearchResults.bind(this);\n  }\n\n  componentDidMount = () => {\n      if(window.location.href.indexOf('_token')==-1){\n          Router.push('/Login')\n      }\n      console.log('cdm ran')\n  }\n\n  submitArtistForm = (event) => {\n      event.preventDefault()\n      const { search_term } = this.state\n      const { access_token } = this.props.url.query\n      \n      if(search_term!=''){\n        fetch(`${spotifySearchURL}${search_term}&type=track&access_token=${access_token}`)\n          .then(response => response.json())\n          .then(json => {\n              this.setState({ tracks: json.tracks.items })\n              return json.tracks\n          })\n      }\n  }\n\n  renderSearchResults = () => {\n      if(this.state.tracks.length > 1){\n          const { tracks } = this.state\n          const { access_token } = this.props.url.query \n          let allResults = []\n          tracks.forEach((track, index) => {\n              if(track.images[0]!=undefined){\n                  let hasImage = track.images[0]\n                  allResults.push(\n                      <Results\n                          key={track.id} \n                          imageURL={hasImage.url}\n                          name={track.name} \n                      >                         \n                       <Link href={`/artist-albums?id=${track.id}&access_token=${access_token}`}>\n                          <a className=\"text-muted\">View {track.name} albums</a>\n                       </Link>\n                      </Results>\n                  )\n              }\n          })\n          return allResults\n      }else{\n          return ''\n      }\n  }\n  \n  render() {\n      console.log('this.state', this.state)\n      const {user} = this.props\n      return (\n          <Layout>\n                <div className=\"row mt-5 justify-content-center\">\n                    <h3>Welcome {user.display_name.split(\" \")[0]}!</h3>\n                </div>\n              <div className=\"row mt-5 justify-content-center\">\n                  <h3>\n                      {\n                          this.state.tracks.length > 1 \n                          ? \n                          `Search results for \"${this.state.search_term}\"` \n                          : \n                          'Search the Spotify API for your favorite artist'\n                      }\n                  </h3>\n              </div>\n              <div className=\"row mt-5 justify-content-center\">\n                  <form onSubmit={event => this.submitArtistForm(event)}>\n                      <div className=\"form-group\">\n                          <input \n                              type=\"text\" \n                              className=\"form-control text-center\" \n                              placeholder=\"enter artist name\"\n                              onChange={event => this.setState({ search_term: event.target.value })} \n                          /> \n                      </div>\n                      <div className=\"form-group\">\n                          <button type=\"submit\" className=\"form-control btn btn-outline-success\">Search</button> \n                      </div>\n                  </form>\n              </div>\n              <div className=\"row mt-5\">\n                  {this.renderSearchResults()}\n              </div>\n          </Layout>\n      );\n  }\n}\n\nApp.getInitialProps = async function(context) {\n    const { access_token } = context.query\n    const res = await fetch(spotifyProfileURL+access_token)\n    const user = await res.json()\n    return { \n        user,\n    }\n}\n\n\nexport default App;"]},"metadata":{},"sourceType":"module"}