{"ast":null,"code":"import auth0 from \"./auth0\";\nimport { attachUserMetadata } from \"./user\";\nexport function authenticatedAction(actionFn) {\n  return auth0.requireAuthentication(async function (req, res) {\n    try {\n      const {\n        user\n      } = await auth0.getSession(req);\n      await attachUserMetadata(user);\n      const actionResult = await actionFn(req, user);\n      res.statusCode = actionResult ? 200 : 204;\n      res.end(JSON.stringify(actionResult));\n    } catch (error) {\n      console.error(error);\n      res.status(error.status || 500).end(error.message && JSON.stringify({\n        message: error.message\n      }));\n    }\n  });\n}","map":{"version":3,"sources":["/Users/gautam/Desktop/cs/48/project-s1-t1-music-queue/utils/api.js"],"names":["auth0","attachUserMetadata","authenticatedAction","actionFn","requireAuthentication","req","res","user","getSession","actionResult","statusCode","end","JSON","stringify","error","console","status","message"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,SAAlB;AACA,SAASC,kBAAT,QAAmC,QAAnC;AAEA,OAAO,SAASC,mBAAT,CAA6BC,QAA7B,EAAuC;AAC5C,SAAOH,KAAK,CAACI,qBAAN,CAA4B,gBAAeC,GAAf,EAAoBC,GAApB,EAAyB;AAC1D,QAAI;AACF,YAAM;AAAEC,QAAAA;AAAF,UAAW,MAAMP,KAAK,CAACQ,UAAN,CAAiBH,GAAjB,CAAvB;AACA,YAAMJ,kBAAkB,CAACM,IAAD,CAAxB;AAEA,YAAME,YAAY,GAAG,MAAMN,QAAQ,CAACE,GAAD,EAAME,IAAN,CAAnC;AAEAD,MAAAA,GAAG,CAACI,UAAJ,GAAiBD,YAAY,GAAG,GAAH,GAAS,GAAtC;AACAH,MAAAA,GAAG,CAACK,GAAJ,CAAQC,IAAI,CAACC,SAAL,CAAeJ,YAAf,CAAR;AACD,KARD,CAQE,OAAOK,KAAP,EAAc;AACdC,MAAAA,OAAO,CAACD,KAAR,CAAcA,KAAd;AACAR,MAAAA,GAAG,CACAU,MADH,CACUF,KAAK,CAACE,MAAN,IAAgB,GAD1B,EAEGL,GAFH,CAEOG,KAAK,CAACG,OAAN,IAAiBL,IAAI,CAACC,SAAL,CAAe;AAAEI,QAAAA,OAAO,EAAEH,KAAK,CAACG;AAAjB,OAAf,CAFxB;AAGD;AACF,GAfM,CAAP;AAgBD","sourcesContent":["import auth0 from \"./auth0\";\nimport { attachUserMetadata } from \"./user\";\n\nexport function authenticatedAction(actionFn) {\n  return auth0.requireAuthentication(async function(req, res) {\n    try {\n      const { user } = await auth0.getSession(req);\n      await attachUserMetadata(user);\n\n      const actionResult = await actionFn(req, user);\n\n      res.statusCode = actionResult ? 200 : 204;\n      res.end(JSON.stringify(actionResult));\n    } catch (error) {\n      console.error(error);\n      res\n        .status(error.status || 500)\n        .end(error.message && JSON.stringify({ message: error.message }));\n    }\n  });\n}\n"]},"metadata":{},"sourceType":"module"}